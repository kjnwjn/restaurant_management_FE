"use strict";(self["webpackChunkstore_system"]=self["webpackChunkstore_system"]||[]).push([[774],{291:function(t,a,s){s.r(a),s.d(a,{default:function(){return f}});var e=function(){var t=this,a=t._self._c;return a("main",[a("Loading",{attrs:{active:t.isLoading,"is-full-page":!0,"can-cancel":!1}}),t.transactionDetail&&!t.transactionDetail.payStatus?a("div",[a("div",{staticClass:"py-2 bg-red-400 hover:bg-red-500 transition-all rounded-full text-white text-center mb-9 font-bold text-lg cursor-pointer",on:{click:t.handleCancelTransaction}},[a("ThemifyIcon",{attrs:{icon:"close"}}),a("button",{staticClass:"ml-3"},[t._v("Cancel this transaction")])],1)]):t._e(),t.transactionDetail&&!t.transactionDetail.payStatus?a("div",{staticClass:"flex mb-8"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.barcode,expression:"barcode"}],staticClass:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full py-2.5 px-4",attrs:{type:"text",placeholder:"Enter barcode here...",disabled:t.transactionDetail&&t.transactionDetail.payStatus},domProps:{value:t.barcode},on:{input:function(a){a.target.composing||(t.barcode=a.target.value)}}}),a("button",{staticClass:"bg-blue-400 py-4 px-8 rounded-lg text-white ml-4 hover:bg-blue-500 transition-all",on:{click:t.orderHandler}},[t._v("Enter")])]):t._e(),a("div",{staticClass:"grid grid-cols-3 p-4"},[a("div",{staticClass:"col-span-2 pr-6"},[a("div",{staticClass:"overflow-x-auto relative"},[a("table",{staticClass:"overflow-scroll w-full text-sm text-left text-gray-500 dark:text-gray-400"},[t._m(0),t.transactionDetail&&t.transactionDetail.details?a("tbody",t._l(t.transactionDetail.details,(function(s,e){return a("tr",{key:e,staticClass:"bg-white border-b dark:bg-gray-800 dark:border-gray-700"},[a("th",{staticClass:"py-4 px-6 font-medium text-gray-900 whitespace-nowrap",attrs:{scope:"row"}},[t._v(" "+t._s(s.barcode)+" ")]),a("td",{staticClass:"py-4 px-6"},[t._v(t._s(s.productName))]),a("td",{staticClass:"py-4 px-6 flex justify-between items-center"},[a("button",{staticClass:"inline-flex items-center p-1 text-sm font-medium text-gray-500 bg-white rounded-full border border-gray-300",attrs:{type:"button"},on:{click:function(a){return t.handleUpdateQuantity(s,"descrease")}}},[a("svg",{staticClass:"w-4 h-4",attrs:{"aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{"fill-rule":"evenodd",d:"M3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z","clip-rule":"evenodd"}})])]),a("div",[a("input",{staticClass:"px-3 py-1 bg-gray-50 w-14 border border-gray-300 text-gray-900 text-sm rounded-lg",attrs:{type:"number"},domProps:{value:s.qty}})]),a("button",{staticClass:"inline-flex items-center p-1 text-sm font-medium text-gray-500 bg-white rounded-full border border-gray-300",attrs:{type:"button"},on:{click:function(a){return t.handleUpdateQuantity(s,"increase")}}},[a("svg",{staticClass:"w-4 h-4",attrs:{"aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"}})])])]),a("td",{staticClass:"py-4 px-6"},[t._v(t._s(t.priceFormat(s.unitCost)))])])})),0):t._e()])])]),a("div",{staticClass:"bg-gray-100 p-4 rounded-md shadow-md"},[a("div",{staticClass:"relative mb-4"},[a("div",{staticClass:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[a("ThemifyIcon",{attrs:{icon:"user"}})],1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.customerID,expression:"customerID"}],staticClass:"block p-4 pl-10 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border",attrs:{type:"text",placeholder:"Customer",disabled:t.transactionDetail&&t.transactionDetail.payStatus},domProps:{value:t.customerID},on:{input:function(a){a.target.composing||(t.customerID=a.target.value)}}}),a("button",{staticClass:"text-white absolute right-2.5 bottom-2.5 transition-all font-medium rounded-lg text-sm px-4 py-2",class:{"bg-blue-400 hover:bg-blue-500 cursor-pointer":t.transactionDetail&&!t.transactionDetail.payStatus,"bg-gray-400 ":t.transactionDetail&&t.transactionDetail.payStatus},attrs:{disabled:t.transactionDetail&&t.transactionDetail.payStatus},on:{click:t.handleAddCustomer}},[t._v(" Add ")])]),a("div",{staticClass:"mb-4"},[a("table",{staticClass:"overflow-scroll w-full text-sm text-left text-gray-500 dark:text-gray-400 mb-4"},[a("tbody",[a("tr",[t._m(1),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.transactionDetail&&t.transactionDetail.transactionID))])])]),a("tr",[t._m(2),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.transactionDetail&&t.transactionDetail.cashierCode))])])]),a("tr",[t._m(3),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.transactionDetail&&t.transactionDetail.cashierName))])])]),a("tr",[t._m(4),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.dateFormat(t.transactionDetail?t.transactionDetail.createdAt:"")))])])]),a("tr",[t._m(5),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.dateFormat(t.transactionDetail?t.transactionDetail.updatedAt:"")))])])]),a("tr",[t._m(6),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.transactionDetail&&t.transactionDetail.customerID?t.transactionDetail.customerID:"N/A"))])])]),t.customerDetail?a("tr",[t._m(7),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.priceFormat(t.customerDetail.point)))])])]):t._e(),a("tr",[t._m(8),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.priceFormat(t.transactionDetail?t.transactionDetail.subTotal:"")))])])]),a("tr",[t._m(9),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.priceFormat(t.transactionDetail?t.transactionDetail.cash:"")))])])]),a("tr",[t._m(10),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.priceFormat(t.transactionDetail?t.transactionDetail.disCount:"")))])])]),a("tr",[t._m(11),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.priceFormat(t.transactionDetail?t.transactionDetail.changeDue:"null")))])])]),a("tr",[t._m(12),a("td",{staticClass:"py-1 px-6"},[a("p",[t._v(": "+t._s(t.priceFormat(t.transactionDetail?t.transactionDetail.totalPrice:"")))])])]),this.customerDetail?a("tr",[a("td",{staticClass:"py-2 pb-3 px-6",attrs:{colspan:"2"}},[a("div",{staticClass:"flex items-center mb-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.allowPoint,expression:"allowPoint"}],staticClass:"w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",attrs:{disabled:t.transactionDetail&&t.transactionDetail.payStatus,id:"default-checkbox",type:"checkbox"},domProps:{checked:Array.isArray(t.allowPoint)?t._i(t.allowPoint,null)>-1:t.allowPoint},on:{change:[function(a){var s=t.allowPoint,e=a.target,r=!!e.checked;if(Array.isArray(s)){var i=null,o=t._i(s,i);e.checked?o<0&&(t.allowPoint=s.concat([i])):o>-1&&(t.allowPoint=s.slice(0,o).concat(s.slice(o+1)))}else t.allowPoint=r},t.togglePointHandler]}}),a("label",{staticClass:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300",attrs:{for:"default-checkbox"}},[t._v("Allow use customer's point")])])])]):t._e()])])]),a("div",{staticClass:"mb-2"},[a("div",{staticClass:"relative mb-4"},[a("div",{staticClass:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[a("ThemifyIcon",{attrs:{icon:"money"}})],1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.cash,expression:"cash"}],staticClass:"block py-4 px-10 w-full text-sm text-gray-900 rounded-lg border mb-4",attrs:{type:"number",placeholder:"Cash",disabled:t.transactionDetail&&t.transactionDetail.payStatus},domProps:{value:t.cash},on:{input:function(a){a.target.composing||(t.cash=a.target.value)}}})]),a("div",{staticClass:"py-3 rounded-full text-white text-center font-bold text-lg transition-all",class:{"bg-blue-400 cursor-pointer hover:bg-blue-500 ":t.transactionDetail&&!t.transactionDetail.payStatus,"bg-gray-400":t.transactionDetail&&t.transactionDetail.payStatus},on:{click:t.handlePay}},[a("ThemifyIcon",{attrs:{icon:"credit-card"}}),a("button",{staticClass:"ml-3",attrs:{disabled:t.transactionDetail&&t.transactionDetail.payStatus}},[t._v("PAY")])],1)])])])],1)},r=[function(){var t=this,a=t._self._c;return a("thead",{staticClass:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[a("tr",[a("th",{staticClass:"py-3 px-6",attrs:{scope:"col"}},[t._v("Barcode")]),a("th",{staticClass:"py-3 px-6",attrs:{scope:"col"}},[t._v("Product name")]),a("th",{staticClass:"py-3 px-6",attrs:{scope:"col"}},[t._v("Qty")]),a("th",{staticClass:"py-3 px-6",attrs:{scope:"col"}},[t._v("Unit cost")])])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("InvoiceID")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Cashier code")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Cashier")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Created at")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Last modified")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Customer")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Customer point")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Sub-total")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Cash")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Discount")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Change due")])])},function(){var t=this,a=t._self._c;return a("th",{staticClass:"py-1 px-6 text-left font-bold text-gray-900 whitespace-nowrap"},[a("p",[t._v("Total price")])])}],i=(s(7658),s(196)),o=s(7973),n=s(8510),c=s(1876),l=s(629),d=s(7398),p=s.n(d),u={data(){return{isLoading:!0,transactionDetail:null,barcode:"",cash:null,customerID:null,customerDetail:null,allowPoint:!1}},async mounted(){this.fetchData()},methods:{dateFormat:n.Z,priceFormat:c.Z,async fetchData(){this.isLoading=!0,await i.ZP.get(`http://localhost:3000/api/v1/transaction/${this.$route.params.transactionID}?token=${this.$store.state.accessToken}`).then((async t=>{t.data.status&&t.data.transactionQuery&&(this.transactionDetail=t.data.transactionQuery,this.allowPoint=t.data.transactionQuery.usePoint,await i.ZP.get(`http://localhost:3000/api/v1/customer/${t.data.transactionQuery.customerID}/detail?token=${this.accessToken}`).then((t=>{t.data.status?this.customerDetail=t.data.data:this.customerDetail=null})))})).catch((()=>this.$router.push("/pos"))),this.isLoading=!1},async handleCancelTransaction(){this.isLoading=!0;const t=this.$route.params.transactionID;await i.ZP["delete"](`http://localhost:3000/api/v1/transaction/${t}/delete?token=${this.$store.state.accessToken}`).then((t=>{t.data.status?(this.$store.state.toastify.success(t.data.msg.en),this.$router.push("/pos")):this.toastify.error(t.data.msg.en)})),this.isLoading=!1},async orderHandler(){this.isLoading=!0,await i.ZP.post(`http://localhost:3000/api/v1/transaction/${this.transactionDetail.transactionID}/order?token=${this.accessToken}`,{barcode:this.barcode}).then((t=>{t.data.status||this.toastify.error(t.data.msg.en)})).catch((t=>{console.log(t),this.toastify.error(t.response.data.msg.en||"Error occurred while processing order.")})),this.fetchData(),this.isLoading=!1},async handlePay(){this.isLoading=!0,await i.ZP.post(`http://localhost:3000/api/v1/transaction/${this.transactionDetail.transactionID}/pay?token=${this.accessToken}`,{cash:this.cash}).then((t=>{t.data.status?this.toastify.success(t.data.msg.en):this.toastify.error(t.data.msg.en)})).catch((t=>{this.toastify.error(t.response.data.msg.en||"Error occurred while processing order.")})),this.fetchData(),this.isLoading=!1},async handleUpdateQuantity(t,a){this.isLoading=!0;let s=t.qty,e=t.barcode;await i.ZP.post(`http://localhost:3000/api/v1/transaction/${this.transactionDetail.transactionID}/order?token=${this.accessToken}`,{barcode:e,qty:"increase"==a?s+=1:s-=1}).then((t=>{t.data.status?this.toastify.success(t.data.msg.en):this.toastify.error(t.data.msg.en)})).catch((t=>{this.toastify.error(t.response.data.msg.en||"Error occurred while processing order.")})),this.fetchData(),this.isLoading=!1},async handleAddCustomer(){this.isLoading=!0,await i.ZP.post(`http://localhost:3000/api/v1/transaction/${this.transactionDetail.transactionID}/add-customer?token=${this.accessToken}`,{customerID:this.customerID}).then((t=>{t.data.status?this.toastify.success(t.data.msg.en):this.toastify.error(t.data.msg.en)})).catch((t=>{this.toastify.error(t.response.data.msg.en||"Error occurred while processing order.")})),this.fetchData(),this.isLoading=!1},async togglePointHandler(){await i.ZP.post(`http://localhost:3000/api/v1/transaction/${this.transactionDetail.transactionID}/toggle-point?token=${this.accessToken}`).then((t=>{console.log(t.data)})),this.fetchData()}},computed:{...(0,l.rn)(["accessToken","payload","toastify"])},components:{ThemifyIcon:o.Z,Loading:p()}},h=u,y=s(1001),m=(0,y.Z)(h,e,r,!1,null,null,null),f=m.exports},1876:function(t,a,s){function e(t){if(t&&t>=1e6){let a=Math.floor(t/1e6),s=Math.floor(t%1e6/1e3),e=Math.floor(t%1e6%1e3);return s=s<100?s<10?`00${s}`:`0${s}`:s,e=e<100?e<10?`00${e}`:`0${e}`:e,`${a},${s},${e} vnđ`}if(t&&t<1e6){let a=Math.floor(t/1e3),s=Math.floor(t)%1e3;return s=s<100?s<10?`00${s}`:`0${s}`:s,`${a},${s} vnđ`}return"0 vnđ"}s.d(a,{Z:function(){return e}})}}]);
//# sourceMappingURL=transactionDetail.82aff0d0.js.map